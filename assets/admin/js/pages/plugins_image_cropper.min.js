$(function(){altair_image_cropper.init()}),altair_image_cropper={init:function(){"use strict";var i=window.console||{log:function(){}},c=$("#image_cropper"),n=$("#image_download");c.on({"build.cropper":function(e){i.log(e.type)},"built.cropper":function(e){i.log(e.type)},"cropstart.cropper":function(e){i.log(e.type,e.action)},"cropmove.cropper":function(e){i.log(e.type,e.action)},"cropend.cropper":function(e){i.log(e.type,e.action)},"crop.cropper":function(e){i.log(e.type,e.x,e.y,e.width,e.height,e.rotate,e.scaleX,e.scaleY)},"zoom.cropper":function(e){i.log(e.type,e.ratio)}}).cropper({aspectRatio:16/9,preview:".cr_preview"}),$.isFunction(document.createElement("canvas").getContext)||$('button[data-method="getCroppedCanvas"]').prop("disabled",!0),void 0===document.createElement("cropper").style.transition&&($('button[data-method="rotate"]').prop("disabled",!0),$('button[data-method="scale"]').prop("disabled",!0)),i.log(void 0===n[0].download),void 0===n[0].download&&n.addClass("disabled"),$(".croper-toggles").on("click","button",function(){if($(this).hasClass("uk-active")){var e=$(this).attr("data-value");if(!c.data("cropper"))return;c.cropper("setAspectRatio",e)}}),$(".cropper-buttons").on("click","[data-method]",function(){var e,t,o=$(this),a=o.data();if(!o.prop("disabled")&&!o.hasClass("disabled")&&c.data("cropper")&&a.method){if(void 0!==(a=$.extend({},a)).target&&(e=$(a.target),void 0===a.option))try{a.option=JSON.parse(e.val())}catch(e){i.log(e.message)}switch(t=c.cropper(a.method,a.option,a.secondOption),a.method){case"scaleX":case"scaleY":$(this).data("option",-a.option);break;case"getCroppedCanvas":if(t){var r="#getCroppedCanvasModal",p=UIkit.modal(r);$(r).find(".canvasModalImage").html(t),p.show(),n.hasClass("disabled")||n.attr("href",t.toDataURL("image/jpeg"))}}if($.isPlainObject(t)&&e)try{e.val(JSON.stringify(t))}catch(e){i.log(e.message)}}}),$(document.body).on("keydown",function(e){if(c.data("cropper")&&!(300<this.scrollTop))switch(e.which){case 37:e.preventDefault(),c.cropper("move",-1,0);break;case 38:e.preventDefault(),c.cropper("move",0,-1);break;case 39:e.preventDefault(),c.cropper("move",1,0);break;case 40:e.preventDefault(),c.cropper("move",0,1)}});var o,a=$("#inputImage"),r=window.URL||window.webkitURL;r?a.change(function(){var e,t=this.files;c.data("cropper")&&t&&t.length&&(e=t[0],/^image\/\w+$/.test(e.type)?(o=r.createObjectURL(e),c.one("built.cropper",function(){r.revokeObjectURL(o)}).cropper("reset").cropper("replace",o),a.val(""),o):window.alert("Please choose an image file."))}):a.prop("disabled",!0).parent().addClass("disabled")}};